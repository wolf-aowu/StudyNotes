# xlwings 库

## 介绍

可以处理 Excel 文件的 Python 模块有很多，如 XlsxWriter、xlrd、xlwt、xlutils、openpyxl 和 xlwings 等。下表对各个模块的功能进行了简单对比。

| 模块\功能  | 读   | 写   | 修改 | 支持 xls 格式 | 支持 xlsx 格式 | 支持批量操作 |
| ---------- | ---- | ---- | ---- | ------------- | -------------- | ------------ |
| XlsxWriter | ×    | ✔    | ×    | ×             | ✔              | ×            |
| xlrd       | ✔    | ×    | ×    | ✔             | ✔              | ×            |
| xlwt       | ×    | ✔    | ×    | ✔             | ✔              | ×            |
| xlutils    | ✔    | ✔    | ✔    | ✔             | ×              | ×            |
| openpyxl   | ✔    | ✔    | ✔    | ×             | ✔              | ×            |
| xlwings    | ✔    | ✔    | ✔    | ✔             | ✔              | ✔            |

通过上表的对比可以发现，xlwings 模块的功能是最齐全的。它不仅能读、写和修改两种格式的 Excel 文件（xls 和 xlsx），而且能批量处理多个 Excel 文件。此外，xlwings 模块还能与 Excel VBA 结合使用，实现更加强大的数据输入和分析功能。

## 方法

### 创建工作簿

```python
import xlwings as xw
app = xw.App(visible=True, add_book=False)
workbook = app.books.add()
```

第 2 行代码启动 Excel 程序窗口，但不新建工作簿。

App()：

入参：

1. visible：用于设置 Excel 程序窗口的可见性。True，表示显示 Excel 程序窗口；False，表示隐藏 Excel 程序窗口。
2. add_book：用于设置启动 Excel 程序窗口后是否新建工作簿。True，表示新建一个工作簿；False，表示不新建工作簿。

第 3 行代码新建一个工作簿。其中的 add() 为 books 对象的函数，用于新建工作簿。

### 保存工作簿

```python
import xlwings as xw
app = xw.App(visible=False, add_book=False)
workbook = app.books.add()
workbook.save('D:\\用 Python 让 Excel 飞起来\\基本操作\\分公司.xlsx')
workbook.close()
app.quit()
```

第 4 行代码中的 save() 函数用于保存前面创建的空白工作簿，括号里的参数为工作簿的保存路径和文件名。该路径可以是绝对路径，也可以时相对路径。如果不提供保存路径且打开的文件时以前未保存过的，将以当前文件名保存在当前工作目录中。如果不提供保存路径且打开的文件是现有的文件，将在不提示的情况下被覆盖。

第 5 行代码中的 close() 函数用于关闭创建的工作簿。 

第 6 行代码中的 quit() 函数用于退出 Excel 程序。

### 打开工作簿

```python
import xlwings as xw
app = xw.App(visible=True, add_book=False)
workbook = app.books.open('D:\\用 Python 让 Excel 飞起来\\基本操作\\分公司.xlsx')
```

### 获取工作表

``` python
worksheet = workbook.sheets['Sheet1']
```

### 新增工作表

``` python
worksheet = workbook.sheets.add('产品统计表')
```

### 单元格赋值

``` python
worksheet.range('A1').value = '编号'
```

